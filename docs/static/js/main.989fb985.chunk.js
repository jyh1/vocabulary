(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{138:function(e,t,n){},139:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(67),u=n.n(c),i=(n(78),n(5)),o=n(7),s=n(4),l=n(68),f=function(e){var t=e.ps;return a.a.createElement("span",{className:"word-pieces"},t.map((function(e,t){return a.a.createElement(p,{wp:e,key:t})})))},p=function(e){var t=e.wp;if("string"===typeof t)return a.a.createElement("ruby",null,t);var n=t.text,r=t.kana;return a.a.createElement("ruby",null,n," ",a.a.createElement("rt",null,r)," ")},d=function(e){var t=e.desc;return a.a.createElement(a.a.Fragment,null,t.split("\n").map((function(e,t){return a.a.createElement("p",{key:t},e)})))},b=(n(79),n(80),function(e){var t=e.children,n=e.active,r=Object(s.a)(t,2),c=r[0],u=r[1];return a.a.createElement("div",{className:n?"tooltip-wrapper active":"tooltip-wrapper"},a.a.createElement("div",{className:n?"tooltip-ele active":"tooltip-ele"},c),a.a.createElement("div",{className:"tooltip-tooltip"},u))}),v=(n(81),function(e){var t=e.icon;return a.a.createElement("i",Object.assign({},e,{className:"fa fa-".concat(t),"aria-hidden":"true"}))}),m=n(69),h=n.n(m),y=(n(84),function(e){var t=e.tag,n=e.onDelete;return a.a.createElement("div",{className:"word-tag"},t.name,a.a.createElement("span",{className:"word-tag-del",onDoubleClick:n},"\u2715"))}),w=function(e){var t=e.tags,n=e.onDelete,r=e.onAddition;return a.a.createElement(h.a,{tags:t.map((function(e){return{id:e,name:e}})),onDelete:n,onAddition:r,allowNew:!0,allowBackspace:!1,tagComponent:y,autoResize:!0,placeholderText:"       "})};function O(e){return e.map((function(e){return"string"===typeof e?e:((t=e.text).length>1?"("+t+")":t)+"("+e.kana+")";var t})).join("")}function j(e){return e.map((function(e){return"string"===typeof e?e:e.text})).join("")}function g(e){var t=e.tags.map((function(e){return"#"+e})).join(" ");return[t,O(e.content),e.description,t].join("\n")}function k(e){return"Insert\n"+function(e){return e.map(g).join("\n")}(e.map((function(e){return e.value})))}function E(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}var x,N=n(1);!function(e){e[e.Character=0]="Character",e[e.LParen=1]="LParen",e[e.RParen=2]="RParen"}(x||(x={}));var P=Object(N.buildLexer)([[!0,/^[^()]/g,x.Character],[!0,/^\(/g,x.LParen],[!0,/^\)/g,x.RParen]]),A=Object(N.apply)(Object(N.tok)(x.Character),(function(e){return e.text})),C=Object(N.apply)(Object(N.rep_sc)(A),(function(e){return e.join("")})),D=Object(N.kmid)(Object(N.tok)(x.LParen),C,Object(N.tok)(x.RParen)),S=Object(N.alt)(A,D),q=Object(N.apply)(Object(N.seq)(S,Object(N.opt_sc)(D)),(function(e){var t=Object(s.a)(e,2),n=t[0],r=t[1];return r?{text:n,kana:r}:n})),L=Object(N.apply)(Object(N.seq)(q,Object(N.rep_sc)(q)),(function(e){var t=Object(s.a)(e,2),n=t[0],r=t[1];return[n].concat(Object(o.a)(r))}));function R(e){return Object(N.expectSingleResult)(Object(N.expectEOF)(L.parse(P.parse(e.trim()))))}var I,_,M,T,B,U=n(9),F=n(24),G=n(25),W=function(){function e(t,n,r,a,c,u){Object(F.a)(this,e),this.lexer=t,this.input=n,this.kind=r,this.text=a,this.pos=c,this.keep=u,this.nextToken=void 0}return Object(G.a)(e,[{key:"next",get:function(){return void 0===this.nextToken&&(this.nextToken=this.lexer.parseNextAvailable(this.input,this.pos.index+this.text.length,this.pos.rowEnd,this.pos.columnEnd),void 0===this.nextToken&&(this.nextToken=null)),null===this.nextToken?void 0:this.nextToken}}]),e}(),K=function(){function e(t){Object(F.a)(this,e),this.rules=t,this._rules=void 0;var n,r=Object(U.a)(this.rules);try{for(r.s();!(n=r.n()).done;){var a=n.value;if("^"!==a[1].source[0])throw new Error('Regular expression patterns for a tokenizer should start with "^": '.concat(a[1].source));if(!a[1].global)throw new Error("Regular expression patterns for a tokenizer should be global: ".concat(a[1].source))}}catch(c){r.e(c)}finally{r.f()}this._rules=t}return Object(G.a)(e,[{key:"parse",value:function(e){return this.rules=this._rules,this.parseNextAvailable(e,0,1,1)}},{key:"parseNext",value:function(e,t,n,r){if(t!==e.length){var a,c,u=e.substr(t),i=Object(U.a)(this.rules);try{for(i.s();!(c=i.n()).done;){var o=Object(s.a)(c.value,3),l=o[0],f=o[1],p=o[2];if(f.lastIndex=0,f.test(u)){var d,b=u.substr(0,f.lastIndex),v=n,m=r,h=Object(U.a)(b);try{for(h.s();!(d=h.n()).done;){switch(d.value){case"\r":break;case"\n":v++,m=1;break;default:m++}}}catch(y){h.e(y)}finally{h.f()}a=new W(this,e,p,b,{index:t,rowBegin:n,columnBegin:r,rowEnd:v,columnEnd:m},l);break}}}catch(y){i.e(y)}finally{i.f()}if(void 0===a)throw new N.TokenError({index:t,rowBegin:n,columnBegin:r,rowEnd:n,columnEnd:r},"Unable to tokenize the rest of the input: ".concat(e.substr(t)));return/^insert/gi.test(a.text)&&(this.rules=this.rules.slice(-3)),a}}},{key:"parseNextAvailable",value:function(e,t,n,r){for(var a;;){if(void 0===(a=this.parseNext(e,void 0===a?t:a.pos.index+a.text.length,void 0===a?n:a.pos.rowEnd,void 0===a?r:a.pos.columnEnd)))return;if(a.keep)return a}}}]),e}();function V(e,t){return{type:I.Atom,t:e,v:t}}function z(e){return V(_.Const,e)}function J(e){return function(t,n){return{type:I.Binop,op:e,l:t,r:n}}}!function(e){e[e.Atom=0]="Atom",e[e.Binop=1]="Binop"}(I||(I={})),function(e){e[e.Tag=0]="Tag",e[e.Var=1]="Var",e[e.Const=2]="Const"}(_||(_={})),function(e){e[e.And=0]="And",e[e.Or=1]="Or",e[e.Add=2]="Add",e[e.Minus=3]="Minus",e[e.Divide=4]="Divide",e[e.Multiply=5]="Multiply",e[e.Equal=6]="Equal",e[e.Less=7]="Less",e[e.Greater=8]="Greater",e[e.LessEq=9]="LessEq",e[e.GreaterEq=10]="GreaterEq",e[e.Power=11]="Power"}(M||(M={})),function(e){e[e.Delete=0]="Delete",e[e.Orderby=1]="Orderby",e[e.Slice=2]="Slice",e[e.Pushtags=3]="Pushtags",e[e.Poptags=4]="Poptags",e[e.Clear=5]="Clear"}(T||(T={})),function(e){e[e.Insert=0]="Insert",e[e.LParen=1]="LParen",e[e.RParen=2]="RParen",e[e.Tag=3]="Tag",e[e.Space=4]="Space",e[e.Line=5]="Line",e[e.And=6]="And",e[e.Or=7]="Or",e[e.True=8]="True",e[e.False=9]="False",e[e.Number=10]="Number",e[e.Power=11]="Power",e[e.Add=12]="Add",e[e.Minus=13]="Minus",e[e.Divide=14]="Divide",e[e.Multiply=15]="Multiply",e[e.Equal=16]="Equal",e[e.Less=17]="Less",e[e.Greater=18]="Greater",e[e.LessEq=19]="LessEq",e[e.GreaterEq=20]="GreaterEq",e[e.Variable=21]="Variable",e[e.Delete=22]="Delete",e[e.Slice=23]="Slice",e[e.Orderby=24]="Orderby",e[e.Colon=25]="Colon",e[e.Pushtags=26]="Pushtags",e[e.Poptags=27]="Poptags",e[e.Clear=28]="Clear",e[e.Dump=29]="Dump"}(B||(B={}));var Y,H,Z,$=(Y=[[!0,/^Insert/gi,B.Insert],[!0,/^Dump/gi,B.Dump],[!0,/^Clear/gi,B.Clear],[!0,/^Pushtags/gi,B.Pushtags],[!0,/^Poptags/gi,B.Poptags],[!0,/^Delete/gi,B.Delete],[!0,/^Orderby/gi,B.Orderby],[!0,/^Slice/gi,B.Slice],[!0,/^true/gi,B.True],[!0,/^false/gi,B.False],[!0,/^\d+(\.\d+)?/g,B.Number],[!0,/^[&]{2}/g,B.And],[!0,/^[|]{2}/g,B.Or],[!0,/^[\^]/g,B.Power],[!0,/^[+]/g,B.Add],[!0,/^[-]/g,B.Minus],[!0,/^[*]/g,B.Multiply],[!0,/^[/]/g,B.Divide],[!0,/^[<][=]/g,B.LessEq],[!0,/^[>][=]/g,B.GreaterEq],[!0,/^[<]/g,B.Less],[!0,/^[>]/g,B.Greater],[!0,/^[=]{2}/g,B.Equal],[!0,/^[:]/g,B.Colon],[!0,/^\$[a-zA-Z0-9]+/g,B.Variable],[!0,/^\(/g,B.LParen],[!0,/^\)/g,B.RParen],[!0,/^\#[a-zA-Z0-9]+/g,B.Tag],[!1,/^[\s]+/g,B.Space],[!0,/^[^\s][^\n]*/g,B.Line]],new K(Y)),Q=Object(N.apply)(Object(N.tok)(B.Line),(function(e){return e.text})),X=Object(N.apply)(Object(N.seq)(Q,Q),(function(e){var t=Object(s.a)(e,2),n=t[0],r=t[1];return{content:R(n),description:r}})),ee=Object(N.apply)(Object(N.tok)(B.Tag),(function(e){return e.text.substr(1)})),te=Object(N.list_sc)(ee,Object(N.nil)()),ne=Object(N.kright)(Object(N.tok)(B.Insert),Object(N.apply)(Object(N.rep_sc)(Object(N.alt)(X,te)),(function(e){return{type:"Insert",words:e}}))),re=Object(N.apply)(Object(N.tok)(B.Dump),(function(){return{type:"Dump"}})),ae=Object(N.alt)(Object(N.apply)(Object(N.tok)(B.True),(function(){return z(!0)})),Object(N.apply)(Object(N.tok)(B.False),(function(){return z(!1)}))),ce=Object(N.apply)(Object(N.tok)(B.Number),(function(e){return+e.text})),ue=Object(N.apply)(ce,(function(e){return z(e)})),ie=Object(N.alt)(ae,ue),oe=Object(N.apply)(Object(N.tok)(B.Variable),(function(e){return V(_.Var,e.text.substr(1))})),se=Object(N.apply)(ee,(function(e){return V(_.Tag,e)})),le=Object(N.alt)(se,ie,oe),fe=[[[B.Power,J(M.Power)]],[[B.Multiply,J(M.Multiply)],[B.Divide,J(M.Divide)]],[[B.Add,J(M.Add)],[B.Minus,J(M.Minus)]],[[B.Equal,J(M.Equal)],[B.Less,J(M.Less)],[B.Greater,J(M.Greater)],[B.GreaterEq,J(M.GreaterEq)],[B.LessEq,J(M.LessEq)]],[[B.And,J(M.And)]],[[B.Or,J(M.Or)]]],pe=Object(N.rule)(),de=Object(N.alt)(le,Object(N.kmid)(Object(N.str)("("),pe,Object(N.str)(")")));for(var be=0,ve=fe;be<ve.length;be++){var me=ve[be].map((function(e){var t=Object(s.a)(e,2),n=t[0],r=t[1];return Object(N.apply)(Object(N.tok)(n),(function(){return r}))})).reduce((function(e,t){return Object(N.alt)(e,t)}));H=de,Z=me,de=Object(N.lrec_sc)(H,Object(N.seq)(Z,H),(function(e,t){return t[0](e,t[1])}))}pe.setPattern(de);var he=Object(N.apply)(Object(N.tok)(B.Delete),(function(){return{type:T.Delete}})),ye=Object(N.apply)(Object(N.tok)(B.Clear),(function(){return{type:T.Clear}})),we=Object(N.apply)(Object(N.kright)(Object(N.tok)(B.Orderby),pe),(function(e){return{type:T.Orderby,value:e}})),Oe=Object(N.seq)(Object(N.opt_sc)(ce),Object(N.tok)(B.Colon),Object(N.opt_sc)(ce)),je=Object(N.apply)(Object(N.kright)(Object(N.tok)(B.Slice),Oe),(function(e){var t=Object(s.a)(e,3),n=t[0],r=(t[1],t[2]);return{type:T.Slice,start:n,end:r}})),ge=Object(N.apply)(Object(N.kright)(Object(N.tok)(B.Pushtags),te),(function(e){return{type:T.Pushtags,tags:e}})),ke=Object(N.apply)(Object(N.kright)(Object(N.tok)(B.Poptags),te),(function(e){return{type:T.Poptags,tags:e}})),Ee=Object(N.alt)(he,we,je,ge,ke,ye),xe=Object(N.rep_sc)(Ee),Ne=Object(N.apply)(Object(N.nil)(),(function(){return z(!0)})),Pe=Object(N.alt)(pe,Ne),Ae=Object(N.alt)(ne,re,Object(N.apply)(Object(N.seq)(Pe,xe),(function(e){var t=Object(s.a)(e,2);return{type:"Filter",expr:t[0],stmts:t[1]}})));var Ce,De=(Ce=Ae,function(e){return Object(N.expectSingleResult)(Object(N.expectEOF)(Ce.parse($.parse(e))))}),Se=function(e){return a.a.createElement("div",{className:"header"},a.a.createElement(qe,e),a.a.createElement(Re,{query:e.query}))},qe=function(e){return a.a.createElement("div",{className:"header-buttons"},a.a.createElement(Le,e),a.a.createElement("button",{onClick:e.toggleHide},a.a.createElement(v,{icon:"eye-slash"})),a.a.createElement("button",{onClick:e.export},a.a.createElement(v,{icon:"file-download"})," "),a.a.createElement("button",{onClick:e.toggleAP},a.a.createElement(v,{icon:e.autoplay?"pause":"play"})))},Le=function(e){var t=e.addWord,n=e.init,c=e.cancel,u=Object(r.useState)([]),i=Object(s.a)(u,2),l=i[0],f=i[1],p=Object(r.useRef)(),d=Object(r.useRef)(),m=Object(r.useState)(!1),h=Object(s.a)(m,2),y=h[0],j=h[1],g=function(){d.current.value="",p.current.value="",d.current.focus()},k=function(){j(!1),P(!1),c()};Object(r.useEffect)((function(){null===n?g():(j(!0),P(!1),p.current.value=n.description,d.current.value=O(n.content),f(n.tags))}),[n]);var E=Object(r.useState)(!1),x=Object(s.a)(E,2),N=x[0],P=x[1],A=function(){try{var e=R(d.current.value),r=p.current.value;t({content:e,description:r,tags:l}).then((function(){g(),null!==n&&k()}))}catch(a){P(!0),console.log(a)}};return a.a.createElement(b,{active:y},a.a.createElement("button",{onClick:function(){return y?k():j(!0)},className:"add"},a.a.createElement(v,{icon:"plus"})),a.a.createElement("div",{className:"newword-form"},a.a.createElement(w,{tags:l,onDelete:function(e){f(l.filter((function(t,n){return n!==e})))},onAddition:function(e){f([].concat(Object(o.a)(l),[e.name]))}}),a.a.createElement("div",{className:"label"},"Word"),a.a.createElement("input",{onKeyDown:function(e){"Escape"===e.key&&Ie(d),P(!1)},ref:d,type:"text",className:N?"word-input error":"word-input",placeholder:"e.g. \u898b(\u307f)\u308b. Press [Esc] to insert ()"}),a.a.createElement("div",{className:"label"},"Definition"),a.a.createElement("textarea",{onKeyDown:function(e){(e.metaKey||e.ctrlKey)&&"Enter"===e.key&&A()},ref:p}),a.a.createElement("div",{className:"buttons"},a.a.createElement("button",{className:"save",onClick:A},a.a.createElement(v,{icon:"save"})),a.a.createElement("button",{className:"cancel",onClick:k},a.a.createElement(v,{icon:"ban"})))))},Re=function(e){var t=e.query,n=Object(r.useState)(!1),c=Object(s.a)(n,2),u=c[0],i=c[1],o=Object(r.useRef)(),l=function(){if(o.current){var e=o.current.value;t(De(e))}};return a.a.createElement("div",{className:"header-query"},a.a.createElement("textarea",{onKeyDown:function(e){"Escape"===e.key&&Ie(o),(e.metaKey||e.ctrlKey)&&"Enter"===e.key&&l()},ref:o,rows:u?20:1,placeholder:"Input query",onFocus:function(){return i(!0)},onBlur:function(){return i(!1)}}),a.a.createElement("span",{className:"icon",onClick:l},a.a.createElement(v,{icon:"search"})))};function Ie(e){var t=e.current.selectionStart;if(null!==t){var n=e.current.value;e.current.value=n.slice(0,t)+"()"+n.slice(t),e.current.selectionStart=t+1,e.current.selectionEnd=t+1}}n(90);var _e=n(2),Me=n.n(_e),Te=n(3),Be=n(29),Ue=n.n(Be);function Fe(e){return Ge.apply(this,arguments)}function Ge(){return(Ge=Object(Te.a)(Me.a.mark((function e(t){var n;return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,t.iterate((function(e,t){n.push([t,e])}));case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var We="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ke=Object.prototype.toString;function Ve(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=We[n[t]>>2],r+=We[(3&n[t])<<4|n[t+1]>>4],r+=We[(15&n[t+1])<<2|n[t+2]>>6],r+=We[63&n[t+2]];return n.length%3===2?r=r.substring(0,r.length-1)+"=":n.length%3===1&&(r=r.substring(0,r.length-2)+"=="),r}function ze(e,t){var n="";if(e&&(n=Ke.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===Ke.call(e.buffer))){var r,a="__lfsc__:";e instanceof ArrayBuffer?(r=e,a+="arbf"):(r=e.buffer,"[object Int8Array]"===n?a+="si08":"[object Uint8Array]"===n?a+="ui08":"[object Uint8ClampedArray]"===n?a+="uic8":"[object Int16Array]"===n?a+="si16":"[object Uint16Array]"===n?a+="ur16":"[object Int32Array]"===n?a+="si32":"[object Uint32Array]"===n?a+="ui32":"[object Float32Array]"===n?a+="fl32":"[object Float64Array]"===n?a+="fl64":t(new Error("Failed to get type for BinaryArray"))),t(a+Ve(r))}else if("[object Blob]"===n){var c=new FileReader;c.onload=function(){var n="~~local_forage_type~"+e.type+"~"+Ve(this.result);t("__lfsc__:blob"+n)},c.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(u){console.error("Couldn't convert value into a JSON string: ",e),t(null,u)}}function Je(e){return new Promise((function(t,n){ze(e,(function(e,r){r?n(r):t(e)}))}))}function Ye(e){return He.apply(this,arguments)}function He(){return(He=Object(Te.a)(Me.a.mark((function e(t){return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map(Je));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ze=Ue.a.createInstance({name:"audio"});function $e(){return Qe.apply(this,arguments)}function Qe(){return(Qe=Object(Te.a)(Me.a.mark((function e(){var t,n;return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fe(Ze);case 2:return t=e.sent,n=t.map((function(e){var t=Object(s.a)(e,2),n=t[0];return Ye(t[1]).then((function(e){return[n,e]}))})),e.next=6,Promise.all(n);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xe(){return(Xe=Object(Te.a)(Me.a.mark((function e(t,n){return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ze.setItem(t,n);case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function et(e){return tt.apply(this,arguments)}function tt(){return(tt=Object(Te.a)(Me.a.mark((function e(t){var n;return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ze.getItem(t);case 2:if(!(n=e.sent)){e.next=5;break}return e.abrupt("return",n);case 5:return e.abrupt("return",[]);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var nt=Ue.a.createInstance({name:"vocabulary"});function rt(){return at.apply(this,arguments)}function at(){return(at=Object(Te.a)(Me.a.mark((function e(){return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fe(nt);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ct(e,t){return ut.apply(this,arguments)}function ut(){return(ut=Object(Te.a)(Me.a.mark((function e(t,n){return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,nt.setItem(t,n);case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var it=0;function ot(e){return st.apply(this,arguments)}function st(){return(st=Object(Te.a)(Me.a.mark((function e(t){var n,r;return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Date.now().toString()+"."+it++,r=Object(i.a)(Object(i.a)({},t),{},{reviewtime:1,lastreview:new Date,reviewed:!1}),e.next=4,ct(n,r);case 4:return e.abrupt("return",{key:n,value:r});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function lt(){return(lt=Object(Te.a)(Me.a.mark((function e(t){return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map(ot));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ft(e,t){return pt.apply(this,arguments)}function pt(){return(pt=Object(Te.a)(Me.a.mark((function e(t,n){var r,a;return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,nt.getItem(t);case 2:if(r=e.sent,void 0===(a=n(r))){e.next=8;break}return e.next=7,ct(t,a);case 7:return e.abrupt("return",a);case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dt(){return(dt=Object(Te.a)(Me.a.mark((function e(t){var n;return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(e){return e.reviewtime+=1,e.lastreview=new Date,e.reviewed=!0,e},e.next=3,ft(t,n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bt(e){return vt.apply(this,arguments)}function vt(){return(vt=Object(Te.a)(Me.a.mark((function e(t){var n,r;return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],r=t||function(){return!0},e.next=4,nt.iterate((function(e,t){r(e)&&n.push({key:t,value:e})}));case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mt(e){var t=function(t){var n=Object(o.a)(e(new Set(t.tags)).keys());if(n.length!=t.tags.length)return t.tags=n,t};return function(e){return ft(e,t)}}function ht(e){return yt.apply(this,arguments)}function yt(){return(yt=Object(Te.a)(Me.a.mark((function e(t){return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,nt.removeItem(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wt(){return(wt=Object(Te.a)(Me.a.mark((function e(){return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,nt.length();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ot(e){return jt.apply(this,arguments)}function jt(){return(jt=Object(Te.a)(Me.a.mark((function e(t){var n;return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(e){if(e.reviewed)return e.reviewed=!1,e},e.next=3,ft(t,n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gt(e){return kt.apply(this,arguments)}function kt(){return(kt=Object(Te.a)(Me.a.mark((function e(t){return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map(Ot));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Et(){return(Et=Object(Te.a)(Me.a.mark((function e(){return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,nt.keys();case 2:gt(e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xt(){return(xt=Object(Te.a)(Me.a.mark((function e(){var t,n;return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rt();case 2:return t=e.sent,e.next=5,$e();case 5:return n=e.sent,e.abrupt("return",JSON.stringify({vocab:t,audio:n}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Nt(e){return function(t){switch(e.type){case I.Atom:return function(e,t){switch(e.t){case _.Tag:return t.tags.includes(e.v);case _.Var:switch(e.v){case"totalReview":return t.reviewtime;case"days":return n=Date.now(),r=t.lastreview.getTime(),(n-r)/864e5;case"rand":return Math.random();case"reviewed":return t.reviewed;default:throw Error("Unknown variable ".concat(e.v))}case _.Const:return e.v}var n,r}(e,t);case I.Binop:var n=Nt(e.l)(t),r=Nt(e.r)(t);return function(e,t,n){if("number"===typeof t&&"number"===typeof n)switch(e){case M.Add:return t+n;case M.Minus:return t-n;case M.Multiply:return t*n;case M.Divide:return t/n;case M.LessEq:return t<=n;case M.GreaterEq:return t>=n;case M.Less:return t<n;case M.Greater:return t>n;case M.Power:return Math.pow(t,n)}if("boolean"===typeof t&&"boolean"===typeof n)switch(e){case M.And:return t&&n;case M.Or:return t||n}if(typeof t===typeof n)switch(e){case M.Equal:return t===n}throw Error("Incmpatible type of binary operator")}(e.op,n,r)}}}function Pt(e){var t={},n=[];return e.forEach((function(e){Array.isArray(e)?e.forEach((function(e){e in t?delete t[e]:t[e]=null})):n.push(Object(i.a)(Object(i.a)({},e),{},{tags:Object.keys(t)}))})),function(e){return lt.apply(this,arguments)}(n)}function At(e){return Ct.apply(this,arguments)}function Ct(){return(Ct=Object(Te.a)(Me.a.mark((function e(t){return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map((function(e){return ht(e.key)})));case 2:return e.abrupt("return",[]);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Dt(e){return St.apply(this,arguments)}function St(){return(St=Object(Te.a)(Me.a.mark((function e(t){return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(t.map((function(e){return Ot(e.key).then((function(t){return Object(i.a)(Object(i.a)({},e),{},{value:t})}))}))));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qt(e){return function(t){return function(n){return Promise.all(n.map((function(n){return e(t)(n.key).then((function(e){return Object(i.a)(Object(i.a)({},n),{},{value:e})}))})))}}}var Lt=qt((function(e){return mt((function(t){var n,r=Object(U.a)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;t.add(a)}}catch(c){r.e(c)}finally{r.f()}return t}))})),Rt=qt((function(e){return mt((function(t){var n,r=Object(U.a)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;t.delete(a)}}catch(c){r.e(c)}finally{r.f()}return t}))}));function It(e){switch(e.type){case T.Delete:return At;case T.Orderby:return function(e){var t=function(t){return Nt(e)(t.value)};return function(e){return new Promise((function(n){return n(function(e,t){var n=e.map((function(e){return[t(e),e]}));return n.sort((function(e,t){return e[0]-t[0]})),n.map((function(e){return e[1]}))}(e,t))}))}}(e.value);case T.Slice:return t=e.start,n=e.end,function(e){return new Promise((function(r){return r(e.slice(void 0===t?0:t,void 0===n?e.length:n))}))};case T.Pushtags:return Lt(e.tags);case T.Poptags:return Rt(e.tags);case T.Clear:return Dt}var t,n}function _t(e){return function(t){var n,r=function(e){return new Promise((function(t){return t(e)}))}(t),a=Object(U.a)(e);try{for(a.s();!(n=a.n()).done;){var c=n.value;r=r.then(c)}}catch(u){a.e(u)}finally{a.f()}return r}}function Mt(){return(Mt=Object(Te.a)(Me.a.mark((function e(t,n){return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(t.map(It))(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Tt=n(70),Bt=n.n(Tt),Ut=(n(94),function(e){var t=e.content,n=e.onClose;return null===t?a.a.createElement(a.a.Fragment,null):a.a.createElement("div",{className:"modal",onKeyDown:function(e){"Escape"===e.key&&n()}},a.a.createElement("div",{className:"modal-content"},t))}),Ft=(n(95),new Audio);function Gt(){return(Gt=Object(Te.a)(Me.a.mark((function e(t){var n,r,a;return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,et(t);case 2:(n=e.sent).length>0&&(r=new Blob(n,{type:"audio/ogg; codecs=opus"}),a=window.URL.createObjectURL(r),Ft.src&&window.URL.revokeObjectURL(Ft.src),Ft.src=a,Ft.play());case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Wt=new(function(){function e(){Object(F.a)(this,e),this.recorder=void 0,this.chunks=void 0,this.audio=void 0,this.key=void 0,this.recorder=null,this.chunks=[],this.audio=new Audio,this.key=null}return Object(G.a)(e,[{key:"setup",value:function(){var e=Object(Te.a)(Me.a.mark((function e(){var t,n=this;return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.recorder){e.next=6;break}return e.next=3,navigator.mediaDevices.getUserMedia({audio:!0});case 3:t=e.sent,this.recorder=new MediaRecorder(t),this.recorder.ondataavailable=function(e){e.data.size>0&&n.chunks.push(e.data)};case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_save",value:function(){null!==this.key&&(!function(e,t){Xe.apply(this,arguments)}(this.key,this.chunks),this.key=null),this.chunks=[]}},{key:"record",value:function(){var e=Object(Te.a)(Me.a.mark((function e(t){return Me.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setup();case 2:if(null===this.key){e.next=5;break}return e.next=5,this.save();case 5:this.key=t,this.recorder&&this.recorder.start(10);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=this;this.recorder&&"recording"===this.recorder.state&&(this.recorder.onstop=function(){return e._save()},this.recorder.stop())}},{key:"startNew",value:function(e){var t=this;return!(!this.recorder||"recording"!==this.recorder.state)&&(this.recorder.onstop=function(){t._save(),t.record(e)},this.recorder.stop(),!0)}}]),e}()),Kt=window.speechSynthesis;function Vt(e){var t=new SpeechSynthesisUtterance(e);Kt.speak(t)}var zt=function(e){var t=e.word,n=e.onClose,r=null===t?null:a.a.createElement(Jt,e);return a.a.createElement(Ut,{content:r,onClose:n})},Jt=function(e){var t=e.word,n=e.prevWord,c=e.nextWord,u=e.onClose,i=e.review,o=e.index,l=e.autoplay,p=e.prevUnreviewed,b=e.nextUnreviewed,m=t.key,h=t.value,y=h.content,w=h.description,O=h.tags,g=h.lastreview,k=h.reviewtime,E=h.reviewed,x=o.widx,N=o.length,P=Object(r.useState)(!1),A=Object(s.a)(P,2),C=A[0],D=A[1],S=Object(r.useState)(!1),q=Object(s.a)(S,2),L=q[0],R=q[1],I=x>0,_=x<N-1,M=function(e,t){return t+(e?" disabled":"")},T=function(){L||function(e){Gt.apply(this,arguments)}(m)};Object(r.useEffect)((function(){!Wt.startNew(m)&&l&&T()}),[m]);var B=function(e){return function(){D(!1),e()}},U=B(n),F=B(c),G=B(b),W=B(p),K=Bt()(g).fromNow(),V=Object(r.useRef)(null);Object(r.useEffect)((function(){var e;null===(e=V.current)||void 0===e||e.focus()}),[]);return a.a.createElement("div",{className:E?"wordcard-wrapper reviewed":"wordcard-wrapper",onKeyDown:function(e){switch(e.key){case"a":U();break;case"s":i();break;case"d":F();break;case"w":D(!C);break;case"q":W();break;case"e":G();break;case"p":L?L&&(R(!1),Wt.save()):L||Wt.record(m).then((function(){return R(!0)}));break;case"f":T();break;case"l":window.open("https://forvo.com/word/".concat(j(t.value.content),"/#ja"),"forvowindow","height=600,width=600");break;case"j":window.open("https://jisho.org/search/".concat(j(t.value.content)),"jishowindow");break;case"x":Vt(t.value.description)}},onMouseDown:function(e){switch(e.button){case 0:T();break;case 4:i()}},onWheel:function(e){e.deltaY>0?e.deltaY<10&&(D(!0),Vt(t.value.description)):e.deltaY>-10&&F()},tabIndex:0,ref:V},a.a.createElement("button",{className:"close",onClick:u},"\xd7"),a.a.createElement("div",{className:"info"},"Reviewed ",K),a.a.createElement("div",{className:"wordcard-nav"},a.a.createElement("div",{className:"wordcard"},a.a.createElement("div",{className:"content"+(C?" uncover":"")},a.a.createElement(f,{ps:y})),a.a.createElement("div",{className:"tags"},O.map((function(e,t){return a.a.createElement("span",{key:t},e)}))),a.a.createElement("div",{className:"description"+(C?" uncover":"")},a.a.createElement(d,{desc:w})),a.a.createElement("div",{className:"buttons"},a.a.createElement("button",{title:"S",disabled:E,onClick:i},"Review ",k))),a.a.createElement("div",{className:M(I,"nav-left"),onClick:U,title:"A"},a.a.createElement(v,{icon:"chevron-left"})),a.a.createElement("div",{className:M(_,"nav-right"),onClick:F,title:"D"},a.a.createElement(v,{icon:"chevron-right"})),a.a.createElement("div",{className:"index"},x+1," / ",N,a.a.createElement("span",{className:"mic"+(L?" active":"")},a.a.createElement(v,{icon:"microphone"})))))},Yt=n(72);var Ht=function(e){Object(l.a)(e);var t,n=Object(r.useState)([]),c=Object(s.a)(n,2),u=c[0],f=c[1],p=Object(r.useState)(!1),d=Object(s.a)(p,2),b=d[0],v=d[1],m=Object(r.useReducer)((t=4,function(e,n){return void 0===n?(e+1)%t:n}),0),h=Object(s.a)(m,2),y=h[0],w=h[1],O=Object(r.useState)(null),j=Object(s.a)(O,2),g=j[0],x=j[1],N=Object(r.useState)(!1),P=Object(s.a)(N,2),A=P[0],C=P[1],D=Object(r.useState)(null),S=Object(s.a)(D,2),q=S[0],L=S[1],R=Object(r.useState)(0),I=Object(s.a)(R,2),_=I[0],M=I[1],T=Object(r.useState)(!1),B=Object(s.a)(T,2),U=B[0],F=B[1],G=Object(r.useState)(100),W=Object(s.a)(G,2),K=W[0],V=W[1];Object(r.useEffect)((function(){(function(){return wt.apply(this,arguments)})().then(M)}));var z=function(){bt().then((function(e){return f(e)}))};Object(r.useEffect)(z,[]);var J=function(e){null===e?x(null):0<=e&&e<u.length&&x(e)},Y=function(e){return function(){ht(u[e].key).then((function(){f(u.filter((function(t,n){return e!==n})))}))}},H=function(e){if(null!==e&&!u[e].value.reviewed){var t=u[e].key;(function(e){return dt.apply(this,arguments)})(t).then((function(n){u[e]={key:t,value:n},C(!A)}))}},Z={onDragEnd:function(e,t){var n=u.splice(e,1)[0];u.splice(t,0,n),C(!A)},nodeSelector:"tr",handleSelector:"a"};return a.a.createElement("div",{className:(1&y?"hide":"")+(U?" busy":"")+(2&y?" hidedef":"")},a.a.createElement("div",{className:"vocabulary"},a.a.createElement(Se,{addWord:null===q?function(e){return ot(e).then((function(e){return f([e].concat(Object(o.a)(u)))}))}:function(e){var t=u[e].key;return function(n){return ft(t,(function(e){return Object(i.a)(Object(i.a)({},e),n)})).then((function(t){u[e].value=t,C(!A)}))}}(q),init:null===q?null:u[q].value,cancel:function(){return L(null)},toggleHide:function(){return w(void 0)},query:function(e){var t;switch(F(!0),e.type){case"Insert":t=Pt(e.words).then((function(e){f([].concat(Object(o.a)(e),Object(o.a)(u)))}));break;case"Filter":t=bt(Nt(e.expr)).then((function(t){return function(e,t){return Mt.apply(this,arguments)}(e.stmts,t)})).then(f);break;case"NewSession":t=function(){return Et.apply(this,arguments)}().then(z);break;case"Dump":(function(){return xt.apply(this,arguments)})().then((function(e){return E((new Date).toISOString()+".txt",e)})),t=new Promise((function(e){return e()}))}t.then((function(){return F(!1)}))},export:function(){E("query.txt",k(u))},autoplay:b,toggleAP:function(){return v(!b)}}),a.a.createElement("div",{className:"table_info"},u.length," out of ",_," words selected."),a.a.createElement(Yt.a,Z,a.a.createElement("table",{className:"word-table"},a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null,"Word"),a.a.createElement("th",null,"Description"),a.a.createElement("th",null,"Tags"))),a.a.createElement("tbody",null,u.slice(0,K).map((function(e,t){return a.a.createElement(Zt,{word:e,key:e.key,activate:function(){J(t)},del:Y(t),review:function(){return H(t)},edit:function(){return L(t)},idx:t})}))))),K<u.length?a.a.createElement("div",{className:"load",onClick:function(){V(K+50)}},"Load More"):a.a.createElement(a.a.Fragment,null)),null!==g?a.a.createElement(zt,{onClose:function(){J(null)},nextWord:function(){J(g+1)},prevWord:function(){J(g-1)},review:function(){return H(g)},word:u[g],index:{widx:g,length:u.length},prevUnreviewed:function(){if(null!==g)for(var e=g-1;e>=0;e--)if(!u[e].value.reviewed){J(e);break}},nextUnreviewed:function(){if(null!==g)for(var e=g+1;e<u.length;e++)if(!u[e].value.reviewed){J(e);break}},autoplay:b}):a.a.createElement(a.a.Fragment,null))},Zt=function(e){var t=e.word,n=e.activate,r=e.del,c=e.review,u=e.edit,i=e.idx,o=t.value,s=o.content,l=o.tags,p=o.description,d=t.value.reviewed;return a.a.createElement("tr",{onClick:n,className:d?"reviewed":""},a.a.createElement("td",null,a.a.createElement("a",{onClick:function(e){return e.stopPropagation()}}),a.a.createElement("div",{className:"content"},a.a.createElement(f,{ps:s}))),a.a.createElement("td",null,a.a.createElement("div",{className:"description"},p)),a.a.createElement("td",{valign:"top"},a.a.createElement("div",{className:"tags"},l.map((function(e,t){return a.a.createElement("span",{key:t},e)})))),a.a.createElement("td",{onClick:function(e){return e.stopPropagation()}},a.a.createElement($t,{idx:i,del:r,review:c,reviewed:d,edit:u})))},$t=function(e){var t=e.del,n=e.review,r=e.reviewed,c=e.edit,u=e.idx;return a.a.createElement("div",{className:"controls"},a.a.createElement("button",{className:"edit",onClick:c},a.a.createElement(v,{icon:"pen-alt"})),a.a.createElement("button",{className:"review",onClick:n},a.a.createElement(v,{icon:r?"book-open":"book"})),a.a.createElement("button",{className:"delete",onDoubleClick:t},a.a.createElement(v,{icon:"trash-alt"})),a.a.createElement("span",{className:"rownumber"},u+1))};n(138);var Qt=function(){return window.onbeforeunload=function(){return"Your work will be lost."},a.a.createElement("div",{className:"app"},a.a.createElement(Ht,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(Qt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},73:function(e,t,n){e.exports=n(139)},78:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){},84:function(e,t,n){},90:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){}},[[73,1,2]]]);
//# sourceMappingURL=main.989fb985.chunk.js.map